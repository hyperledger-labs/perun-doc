<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="673px" preserveAspectRatio="none" style="width:521px;height:673px;" version="1.1" viewBox="0 0 521 673" width="521px" zoomAndPan="magnify"><defs><filter height="300%" id="f19h5p3n51zwxp" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f19h5p3n51zwxp)" height="525.2031" style="stroke:#000000;stroke-width:2.0;" width="494" x="10" y="57.2969"/><rect fill="#FFFFFF" filter="url(#f19h5p3n51zwxp)" height="364.4063" style="stroke:#000000;stroke-width:2.0;" width="474" x="20" y="81.4297"/><rect fill="#FFFFFF" filter="url(#f19h5p3n51zwxp)" height="216.6094" style="stroke:#000000;stroke-width:2.0;" width="445" x="30" y="222.2266"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="65" x2="65" y1="40.2969" y2="599.5"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="257.5" x2="257.5" y1="40.2969" y2="599.5"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="442" x2="442" y1="40.2969" y2="599.5"/><rect fill="#FEFECE" filter="url(#f19h5p3n51zwxp)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="46" x="40" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="47" y="24.9951">Alice</text><rect fill="#FEFECE" filter="url(#f19h5p3n51zwxp)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="99" x="206.5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="85" x="213.5" y="24.9951">Parent Layer</text><rect fill="#FEFECE" filter="url(#f19h5p3n51zwxp)" height="30.2969" style="stroke:#A80036;stroke-width:1.5;" width="42" x="419" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="426" y="24.9951">Bob</text><path d="M10,57.2969 L80,57.2969 L80,64.2969 L70,74.2969 L10,74.2969 L10,57.2969 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="525.2031" style="stroke:#000000;stroke-width:2.0;" width="494" x="10" y="57.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="25" y="70.3638">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="149" x="95" y="69.5073">[if channel has an app]</text><path d="M20,81.4297 L97,81.4297 L97,88.4297 L87,98.4297 L20,98.4297 L20,81.4297 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="364.4063" style="stroke:#000000;stroke-width:2.0;" width="474" x="20" y="81.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="35" y="94.4966">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="377" x="112" y="93.6401">[until challenge duration for on-chain progression expires]</text><line style="stroke:#0000FF;stroke-width:1.0;" x1="65" x2="107" y1="134.8281" y2="134.8281"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="107" x2="107" y1="134.8281" y2="147.8281"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="66" x2="107" y1="147.8281" y2="147.8281"/><polygon fill="#0000FF" points="76,143.8281,66,147.8281,76,151.8281,72,147.8281" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="143" x="72" y="114.6294">Progress app on-chain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="75" x="72" y="129.7622">(next state)</text><polygon fill="#A80036" points="246,203.2266,256,207.2266,246,211.2266,250,207.2266" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="65" x2="252" y1="207.2266" y2="207.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="77" y="171.895">Progress channel on-chain</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="99" x="112" y="187.0278">(next state with</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="132" x="95.5" y="202.1606">only actor signature)</text><path d="M30,222.2266 L100,222.2266 L100,229.2266 L90,239.2266 L30,239.2266 L30,222.2266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="216.6094" style="stroke:#000000;stroke-width:2.0;" width="445" x="30" y="222.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="45" y="235.2935">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="301" x="115" y="234.437">[if challenge duration for on-chain progression</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="207" x="115" y="247.2417">has started, but not expired and</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="261" x="115" y="260.0464">progression is valid for the channel app]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="258" x2="300" y1="329.3047" y2="329.3047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="300" x2="300" y1="329.3047" y2="342.3047"/><line style="stroke:#A80036;stroke-width:1.0;" x1="259" x2="300" y1="342.3047" y2="342.3047"/><polygon fill="#A80036" points="269,338.3047,259,342.3047,269,346.3047,265,342.3047" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="265" y="278.8403">Update registered state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="24" x="265" y="293.9731">and</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="265" y="309.106">restart challenge duration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="265" y="324.2388">for on-chain progression</text><polygon fill="#A80036" points="76,382.5703,66,386.5703,76,390.5703,72,386.5703" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="70" x2="257" y1="386.5703" y2="386.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="117" y="366.3716">Channel state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="96" y="381.5044">progressed on-chain</text><polygon fill="#A80036" points="430,426.8359,440,430.8359,430,434.8359,434,430.8359" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="258" x2="436" y1="430.8359" y2="430.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="305.5" y="410.6372">Channel state</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="284.5" y="425.77">progressed on-chain</text><line style="stroke:#A80036;stroke-width:1.0;" x1="258" x2="300" y1="504.2344" y2="504.2344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="300" x2="300" y1="504.2344" y2="517.2344"/><line style="stroke:#A80036;stroke-width:1.0;" x1="259" x2="300" y1="517.2344" y2="517.2344"/><polygon fill="#A80036" points="269,513.2344,259,517.2344,269,521.2344,265,517.2344" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="265" y="468.9028">Wait for challenge duration</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="265" y="484.0356">for on-chain progression</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="56" x="265" y="499.1685">to expire</text><line style="stroke:#A80036;stroke-width:1.0;" x1="258" x2="300" y1="561.5" y2="561.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="300" x2="300" y1="561.5" y2="574.5"/><line style="stroke:#A80036;stroke-width:1.0;" x1="259" x2="300" y1="574.5" y2="574.5"/><polygon fill="#A80036" points="269,570.5,259,574.5,269,578.5,265,574.5" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="265" y="541.3013">Channel finalized</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="55" x="265" y="556.4341">on-chain</text><rect fill="#DDDDDD" height="58.8906" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="201" x="304" y="598.5"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="310" y="616.4951">Note:</text><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="310" y="632.792">Blue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="349" y="632.792">arrow indicates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="310" y="649.0889">user interaction is required.</text><!--MD5=[4c6380358bd87e5df115ff53860f91d1]
@startuml finalize_generic_forceupdate
hide footbox
skinparam SequenceMessageAlign center

participant "Alice" as alice
participant "Parent Layer" as parentLayer
participant "Bob" as bob


opt if channel has an app
loop until challenge duration for on-chain progression expires
alice -[#blue]> alice: Progress app on-chain\n(next state)
alice -> parentLayer: Progress channel on-chain\n(next state with\nonly actor signature)
opt if challenge duration for on-chain progression\nhas started, but not expired and\nprogression is valid for the channel app
parentLayer -> parentLayer: Update registered state\nand\nrestart challenge duration\nfor on-chain progression
alice <- parentLayer: Channel state\nprogressed on-chain
parentLayer -> bob: Channel state\nprogressed on-chain
end
end
parentLayer -> parentLayer: Wait for challenge duration\nfor on-chain progression\nto expire
parentLayer -> parentLayer: Channel finalized\non-chain 
end

legend bottom right
<b>Note:</b>
<color:blue>Blue </color> arrow indicates
user interaction is required.
endlegend

@enduml

PlantUML version 1.2020.21(Mon Nov 30 16:40:11 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>