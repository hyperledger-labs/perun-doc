<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1196px" preserveAspectRatio="none" style="width:730px;height:1196px;" version="1.1" viewBox="0 0 730 1196" width="730px" zoomAndPan="magnify"><defs><filter height="300%" id="f1h7urkokn6owj" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f1h7urkokn6owj)" height="81.5313" style="stroke:#000000;stroke-width:2.0;" width="239" x="255" y="304.2188"/><rect fill="#FFFFFF" filter="url(#f1h7urkokn6owj)" height="375.0703" style="stroke:#000000;stroke-width:2.0;" width="526" x="8" y="398.75"/><rect fill="#FFFFFF" height="111.2031" style="stroke:none;stroke-width:1.0;" width="526" x="8" y="662.6172"/><rect fill="#FFFFFF" filter="url(#f1h7urkokn6owj)" height="146.3359" style="stroke:#000000;stroke-width:2.0;" width="155" x="255" y="497.2813"/><rect fill="#FFFFFF" height="56.9375" style="stroke:none;stroke-width:1.0;" width="155" x="255" y="586.6797"/><rect fill="#FFFFFF" filter="url(#f1h7urkokn6owj)" height="308.2656" style="stroke:#000000;stroke-width:2.0;" width="635" x="57" y="786.8203"/><rect fill="#FFFFFF" height="145.4688" style="stroke:none;stroke-width:1.0;" width="635" x="57" y="949.6172"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="73" x2="73" y1="72.8906" y2="1114.0859"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="271" x2="271" y1="72.8906" y2="1114.0859"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="478" x2="478" y1="72.8906" y2="1114.0859"/><rect fill="#FEFECE" filter="url(#f1h7urkokn6owj)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="87" x="27.5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="32" x="55" y="41.292">Alice</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="73" x="34.5" y="57.5889">(Proposer)</text><rect fill="#FEFECE" filter="url(#f1h7urkokn6owj)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="104" x="217" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="250" y="24.9951">Ingrid</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="68" x="235" y="41.292">(Common</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="90" x="224" y="57.5889">Intermediary)</text><rect fill="#FEFECE" filter="url(#f1h7urkokn6owj)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="91" x="430.5" y="21.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="28" x="462" y="41.292">Bob</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="437.5" y="57.5889">(Proposee)</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="177.6875" y2="177.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="177.6875" y2="190.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="190.6875" y2="190.6875"/><polygon fill="#A80036" points="84,186.6875,74,190.6875,84,194.6875,80,190.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="80" y="96.9575">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="80" y="112.0903">parent ledger channel 1</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="80" y="127.2231">(between alice &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="80" y="142.356">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="80" y="157.4888">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="80" y="172.6216">as per opening balance</text><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="520" y1="177.6875" y2="177.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="520" x2="520" y1="177.6875" y2="190.6875"/><line style="stroke:#A80036;stroke-width:1.0;" x1="479" x2="520" y1="190.6875" y2="190.6875"/><polygon fill="#A80036" points="489,186.6875,479,190.6875,489,194.6875,485,190.6875" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="485" y="96.9575">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="485" y="112.0903">parent ledger channel 2</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="485" y="127.2231">(between bob &amp;ingrid)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="485" y="142.356">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="485" y="157.4888">for the virtual channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="485" y="172.6216">as per opening balance</text><polygon fill="#A80036" points="259,230.9531,269,234.9531,259,238.9531,263,234.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="265" y1="234.9531" y2="234.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="214.7544">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="229.8872">parent ledger channel 1</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="279.2188" y2="279.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="279.2188" y2="292.2188"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="292.2188" y2="292.2188"/><polygon fill="#A80036" points="282,288.2188,272,292.2188,282,296.2188,278,292.2188" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="278" y="259.02">Wait for matching</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="278" y="274.1528">update from Bob</text><path d="M255,304.2188 L325,304.2188 L325,311.2188 L315,321.2188 L255,321.2188 L255,304.2188 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="81.5313" style="stroke:#000000;stroke-width:2.0;" width="239" x="255" y="304.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="270" y="317.2856">opt</text><polygon fill="#A80036" points="282,373.75,272,377.75,282,381.75,278,377.75" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="276" x2="477" y1="377.75" y2="377.75"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="117" x="316" y="342.4185">(Matching update)</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="357.5513">Send the update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="372.6841">parent ledger channel 2</text><path d="M8,398.75 L78,398.75 L78,405.75 L68,415.75 L8,415.75 L8,398.75 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="375.0703" style="stroke:#000000;stroke-width:2.0;" width="526" x="8" y="398.75"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="23" y="411.8169">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="378" x="93" y="410.9604">[when matching update is received withing expected time]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="8" x2="534" y1="663.6172" y2="663.6172"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="13" y="673.8276">[else]</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="472.2813" y2="472.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="472.2813" y2="485.2813"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="485.2813" y2="485.2813"/><polygon fill="#A80036" points="282,481.2813,272,485.2813,282,489.2813,278,485.2813" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="159" x="278" y="436.9497">Validate the two updates</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="193" x="278" y="452.0825">(Parameters of virtual channel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="278" y="467.2153">in both must match)</text><path d="M255,497.2813 L325,497.2813 L325,504.2813 L315,514.2813 L255,514.2813 L255,497.2813 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="146.3359" style="stroke:#000000;stroke-width:2.0;" width="155" x="255" y="497.2813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="270" y="510.3481">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="54" x="340" y="509.4917">[if valid]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="255" x2="410" y1="587.6797" y2="587.6797"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="260" y="597.8901">[else]</text><line style="stroke:#0000FF;stroke-width:1.0;" x1="271" x2="313" y1="555.6797" y2="555.6797"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="313" x2="313" y1="555.6797" y2="568.6797"/><line style="stroke:#0000FF;stroke-width:1.0;" x1="272" x2="313" y1="568.6797" y2="568.6797"/><polygon fill="#0000FF" points="282,564.6797,272,568.6797,282,572.6797,278,568.6797" style="stroke:#0000FF;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="61" x="278" y="535.481">Accept or</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="36" x="278" y="550.6138">reject</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="622.6172" y2="622.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="622.6172" y2="635.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="635.6172" y2="635.6172"/><polygon fill="#A80036" points="282,631.6172,272,635.6172,282,639.6172,278,635.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="278" y="617.5513">Reject</text><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="313" y1="698.5547" y2="698.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="313" x2="313" y1="698.5547" y2="711.5547"/><line style="stroke:#A80036;stroke-width:1.0;" x1="272" x2="313" y1="711.5547" y2="711.5547"/><polygon fill="#A80036" points="282,707.5547,272,711.5547,282,715.5547,278,711.5547" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="39" x="278" y="693.4888">Reject</text><path d="M29,724.5547 L29,764.5547 L509,764.5547 L509,734.5547 L499,724.5547 L29,724.5547 " fill="#D3D3D3" filter="url(#f1h7urkokn6owj)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M499,724.5547 L499,734.5547 L509,734.5547 L499,724.5547 " fill="#D3D3D3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="459" x="35" y="741.6216">For the participant from whom update was received, reject immediately.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="419" x="35" y="756.7544">For other participants, reject when a matching update is received.</text><path d="M57,786.8203 L127,786.8203 L127,793.8203 L117,803.8203 L57,803.8203 L57,786.8203 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="308.2656" style="stroke:#000000;stroke-width:2.0;" width="635" x="57" y="786.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="72" y="799.8872">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="66" x="142" y="799.0308">[if accept]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="57" x2="692" y1="950.6172" y2="950.6172"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="60" x="62" y="960.8276">[if reject]</text><polygon fill="#A80036" points="84,841.2188,74,845.2188,84,849.2188,80,845.2188" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="78" x2="270" y1="845.2188" y2="845.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="103" y="825.02">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="840.1528">parent ledger channel 1</text><polygon fill="#A80036" points="466,885.4844,476,889.4844,466,893.4844,470,889.4844" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="472" y1="889.4844" y2="889.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="305.5" y="869.2856">Accept the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="884.4185">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="918.6172" y2="918.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="918.6172" y2="931.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="931.6172" y2="931.6172"/><polygon fill="#A80036" points="84,927.6172,74,931.6172,84,935.6172,80,931.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="80" y="913.5513">Virtual channel is funded</text><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="520" y1="918.6172" y2="918.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="520" x2="520" y1="918.6172" y2="931.6172"/><line style="stroke:#A80036;stroke-width:1.0;" x1="479" x2="520" y1="931.6172" y2="931.6172"/><polygon fill="#A80036" points="489,927.6172,479,931.6172,489,935.6172,485,931.6172" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="157" x="485" y="913.5513">Virtual channel is funded</text><polygon fill="#A80036" points="84,996.6875,74,1000.6875,84,1004.6875,80,1000.6875" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="78" x2="270" y1="1000.6875" y2="1000.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="105.5" y="980.4888">Reject the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="96" y="995.6216">parent ledger channel 1</text><polygon fill="#A80036" points="466,1040.9531,476,1044.9531,466,1048.9531,470,1044.9531" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="271" x2="472" y1="1044.9531" y2="1044.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="133" x="308" y="1024.7544">Reject the update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="298.5" y="1039.8872">parent ledger channel 2</text><line style="stroke:#A80036;stroke-width:1.0;" x1="73" x2="115" y1="1074.0859" y2="1074.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="115" x2="115" y1="1074.0859" y2="1087.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="74" x2="115" y1="1087.0859" y2="1087.0859"/><polygon fill="#A80036" points="84,1083.0859,74,1087.0859,84,1091.0859,80,1087.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="80" y="1069.02">Virtual channel funding failed</text><line style="stroke:#A80036;stroke-width:1.0;" x1="478" x2="520" y1="1074.0859" y2="1074.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="520" x2="520" y1="1074.0859" y2="1087.0859"/><line style="stroke:#A80036;stroke-width:1.0;" x1="479" x2="520" y1="1087.0859" y2="1087.0859"/><polygon fill="#A80036" points="489,1083.0859,479,1087.0859,489,1091.0859,485,1087.0859" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="485" y="1069.02">Virtual channel funding failed</text><rect fill="#DDDDDD" height="58.8906" rx="5" ry="5" style="stroke:#000000;stroke-width:1.0;" width="201" x="513.5" y="1122.0859"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="519.5" y="1140.0811">Note:</text><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="519.5" y="1156.3779">Blue</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="104" x="558.5" y="1156.3779">arrow indicates</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="189" x="519.5" y="1172.6748">user interaction is required.</text><!--MD5=[dd870be7bd290ba7eef77503ffef4654]
@startuml open_funding_virtual
!pragma teoz true
hide footbox
skinparam SequenceMessageAlign center

participant "Alice\n(Proposer)" as alice
participant "Ingrid\n(Common\nIntermediary)" as ingrid
participant "Bob\n(Proposee)" as bob

alice -> alice: Generate an update on\nparent ledger channel 1\n(between alice &ingrid)\nthat locks the funds\nfor the virtual channel ID\nas per opening balance
&bob -> bob: Generate an update on\nparent ledger channel 2\n(between bob &ingrid)\nthat locks the funds\nfor the virtual channel ID\nas per opening balance

alice -> ingrid: Send the update on the\nparent ledger channel 1

ingrid -> ingrid: Wait for matching\nupdate from Bob
opt
ingrid <- bob: (Matching update)\nSend the update on the\nparent ledger channel 2
end

opt when matching update is received withing expected time
ingrid -> ingrid: Validate the two updates\n(Parameters of virtual channel\nin both must match)
opt if valid
ingrid -[#blue]> ingrid: Accept or\nreject
else else
ingrid -> ingrid: Reject
end

else else
ingrid -> ingrid: Reject
note over ingrid #LightGray
For the participant from whom update was received, reject immediately.
For other participants, reject when a matching update is received.
end note

end

opt if accept
alice <- ingrid: Accept the update on\nparent ledger channel 1
ingrid -> bob: Accept the update on\nparent ledger channel 2

alice -> alice: Virtual channel is funded
&bob -> bob: Virtual channel is funded
else if reject
alice <- ingrid: Reject the update on\nparent ledger channel 1
ingrid -> bob: Reject the update on\nparent ledger channel 2

alice -> alice: Virtual channel funding failed
&bob -> bob: Virtual channel funding failed
end

legend bottom right
<b>Note:</b>
<color:blue>Blue </color> arrow indicates
user interaction is required.
endlegend

@enduml

PlantUML version 1.2020.21(Mon Nov 30 16:40:11 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>