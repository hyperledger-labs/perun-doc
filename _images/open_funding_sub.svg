<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="581px" preserveAspectRatio="none" style="width:743px;height:581px;" version="1.1" viewBox="0 0 743 581" width="743px" zoomAndPan="magnify"><defs><filter height="300%" id="f1wskzj9gdgiqd" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" height="569.5625" style="stroke:#A80036;stroke-width:1.0;" width="281" x="11" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="35" x="134" y="18.0669">Alice</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79" x="112" y="33.1997">(Proposer)</text><rect fill="#FFFFFF" height="569.5625" style="stroke:#A80036;stroke-width:1.0;" width="279" x="336" y="6"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="29" x="461" y="18.0669">Bob</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="82" x="434.5" y="33.1997">(Proposee)</text><rect fill="#FFFFFF" filter="url(#f1wskzj9gdgiqd)" height="298.6094" style="stroke:#000000;stroke-width:2.0;" width="688.5" x="41" y="251.9531"/><rect fill="#FFFFFF" height="72.0703" style="stroke:none;stroke-width:1.0;" width="688.5" x="41" y="478.4922"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="68.5" x2="68.5" y1="108.1563" y2="569.5625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="224.5" x2="224.5" y1="108.1563" y2="569.5625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="403.5" x2="403.5" y1="108.1563" y2="569.5625"/><line style="stroke:#A80036;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="557.5" x2="557.5" y1="108.1563" y2="569.5625"/><rect fill="#FEFECE" filter="url(#f1wskzj9gdgiqd)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="103" x="15" y="56.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="68.5" y="76.5576"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="22" y="92.8545">Sub-Channel</text><rect fill="#FEFECE" filter="url(#f1wskzj9gdgiqd)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="123" x="161" y="40.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="224.5" y="60.2607"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="200" y="76.5576">Parent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="168" y="92.8545">Ledger Channel</text><rect fill="#FEFECE" filter="url(#f1wskzj9gdgiqd)" height="62.8906" style="stroke:#A80036;stroke-width:1.5;" width="123" x="340" y="40.2656"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="403.5" y="60.2607"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="45" x="379" y="76.5576">Parent</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="109" x="347" y="92.8545">Ledger Channel</text><rect fill="#FEFECE" filter="url(#f1wskzj9gdgiqd)" height="46.5938" style="stroke:#A80036;stroke-width:1.5;" width="103" x="504" y="56.5625"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="0" x="557.5" y="76.5576"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="89" x="511" y="92.8545">Sub-Channel</text><polygon fill="#A80036" points="212.5,133.2891,222.5,137.2891,212.5,141.2891,216.5,137.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="68.5" x2="218.5" y1="137.2891" y2="137.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="90" y="132.2231">Fund sub-channel</text><polygon fill="#A80036" points="414.5,133.2891,404.5,137.2891,414.5,141.2891,410.5,137.2891" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="408.5" x2="556.5" y1="137.2891" y2="137.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="424" y="132.2231">Fund sub-channel</text><line style="stroke:#A80036;stroke-width:1.0;" x1="224.5" x2="266.5" y1="226.9531" y2="226.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="266.5" x2="266.5" y1="226.9531" y2="239.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="225.5" x2="266.5" y1="239.9531" y2="239.9531"/><polygon fill="#A80036" points="235.5,235.9531,225.5,239.9531,235.5,243.9531,231.5,239.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="231.5" y="161.356">Generate an update on</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="165" x="231.5" y="176.4888">the parent ledger channel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="231.5" y="191.6216">that locks the funds</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="231.5" y="206.7544">for the sub-channel ID</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="149" x="231.5" y="221.8872">as per opening balance</text><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="445.5" y1="226.9531" y2="226.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="445.5" x2="445.5" y1="226.9531" y2="239.9531"/><line style="stroke:#A80036;stroke-width:1.0;" x1="404.5" x2="445.5" y1="239.9531" y2="239.9531"/><polygon fill="#A80036" points="414.5,235.9531,404.5,239.9531,414.5,243.9531,410.5,239.9531" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="410.5" y="191.6216">Wait for the specific</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="90" x="410.5" y="206.7544">update on the</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="140" x="410.5" y="221.8872">parent ledger channel</text><path d="M41,251.9531 L105,251.9531 L105,258.9531 L95,268.9531 L41,268.9531 L41,251.9531 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="298.6094" style="stroke:#000000;stroke-width:2.0;" width="688.5" x="41" y="251.9531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="56" y="265.02">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="304" x="120" y="264.1636">[if update is received within expected time and</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="315" x="120" y="276.9683">other participant responds within expected time]</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="41" x2="729.5" y1="479.4922" y2="479.4922"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="37" x="46" y="489.7026">[else]</text><polygon fill="#A80036" points="391.5,301.8281,401.5,305.8281,391.5,309.8281,395.5,305.8281" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="224.5" x2="397.5" y1="305.8281" y2="305.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="273" y="300.7622">Send update</text><polygon fill="#A80036" points="235.5,330.9609,225.5,334.9609,235.5,338.9609,231.5,334.9609" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="229.5" x2="402.5" y1="334.9609" y2="334.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="44" x="292" y="329.895">Accept</text><path d="M62,347.9609 L62,387.9609 L562,387.9609 L562,357.9609 L552,347.9609 L62,347.9609 " fill="#D3D3D3" filter="url(#f1wskzj9gdgiqd)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M552,347.9609 L552,357.9609 L562,357.9609 L552,347.9609 " fill="#D3D3D3" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="479" x="68" y="365.0278">Both the participants have already agreed to establish a sub-channel using</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="457" x="68" y="380.1606">this ledger channel. So, automatically accept without involving the user.</text><polygon fill="#A80036" points="79.5,414.3594,69.5,418.3594,79.5,422.3594,75.5,418.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="73.5" x2="223.5" y1="418.3594" y2="418.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="86.5" y="413.2935">Funding successful</text><polygon fill="#A80036" points="545.5,414.3594,555.5,418.3594,545.5,422.3594,549.5,418.3594" style="stroke:#A80036;stroke-width:1.0;"/><line style="stroke:#A80036;stroke-width:1.0;" x1="403.5" x2="551.5" y1="418.3594" y2="418.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="420.5" y="413.2935">Funding successful</text><line style="stroke:#A80036;stroke-width:1.0;" x1="68.5" x2="110.5" y1="447.4922" y2="447.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110.5" x2="110.5" y1="447.4922" y2="460.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="69.5" x2="110.5" y1="460.4922" y2="460.4922"/><polygon fill="#A80036" points="79.5,456.4922,69.5,460.4922,79.5,464.4922,75.5,460.4922" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="75.5" y="442.4263">Sub-channel is funded</text><line style="stroke:#A80036;stroke-width:1.0;" x1="557.5" x2="599.5" y1="447.4922" y2="447.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="599.5" x2="599.5" y1="447.4922" y2="460.4922"/><line style="stroke:#A80036;stroke-width:1.0;" x1="558.5" x2="599.5" y1="460.4922" y2="460.4922"/><polygon fill="#A80036" points="568.5,456.4922,558.5,460.4922,568.5,464.4922,564.5,460.4922" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="142" x="564.5" y="442.4263">Sub-channel is funded</text><line style="stroke:#A80036;stroke-width:1.0;" x1="68.5" x2="110.5" y1="529.5625" y2="529.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="110.5" x2="110.5" y1="529.5625" y2="542.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="69.5" x2="110.5" y1="542.5625" y2="542.5625"/><polygon fill="#A80036" points="79.5,538.5625,69.5,542.5625,79.5,546.5625,75.5,542.5625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="75.5" y="509.3638">Sub-channel funding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="75.5" y="524.4966">failed</text><line style="stroke:#A80036;stroke-width:1.0;" x1="557.5" x2="599.5" y1="529.5625" y2="529.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="599.5" x2="599.5" y1="529.5625" y2="542.5625"/><line style="stroke:#A80036;stroke-width:1.0;" x1="558.5" x2="599.5" y1="542.5625" y2="542.5625"/><polygon fill="#A80036" points="568.5,538.5625,558.5,542.5625,568.5,546.5625,564.5,542.5625" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="564.5" y="509.3638">Sub-channel funding</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="34" x="564.5" y="524.4966">failed</text><!--MD5=[f5f38c5734c5b6ee62b64d3a6e88d8c8]
@startuml open_funding_sub
!pragma teoz true
hide footbox
skinparam SequenceMessageAlign center

box "Alice\n(Proposer)" #transparent
participant "\nSub-Channel" as alice
participant "\nParent\nLedger Channel" as alice_parent
end box
box "Bob\n(Proposee)" #transparent
participant "\nParent\nLedger Channel" as bob_parent
participant "\nSub-Channel" as bob
end box

alice -> alice_parent: Fund sub-channel
&bob_parent <- bob: Fund sub-channel

alice_parent -> alice_parent: Generate an update on\nthe parent ledger channel\nthat locks the funds\nfor the sub-channel ID\nas per opening balance
&bob_parent -> bob_parent: Wait for the specific \nupdate on the\nparent ledger channel

alt if update is received within expected time and\nother participant responds within expected time
alice_parent -> bob_parent: Send update
alice_parent <- bob_parent: Accept

note over alice_parent, bob_parent #LightGray
Both the participants have already agreed to establish a sub-channel using
this ledger channel. So, automatically accept without involving the user.
end note

alice <- alice_parent: Funding successful
&bob_parent -> bob: Funding successful

alice -> alice: Sub-channel is funded
&bob -> bob: Sub-channel is funded

else else
alice -> alice: Sub-channel funding\nfailed
&bob -> bob: Sub-channel funding\nfailed
end

@enduml

PlantUML version 1.2020.21(Mon Nov 30 16:40:11 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>